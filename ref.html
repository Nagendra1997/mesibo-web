<!-- mesibo.com -->

<!DOCTYPE html>
<html lang="en">
<head>

  <title>Mesibo Messenger</title>

  <!--SCRIPTINCLUDESTART-->
    <script type="text/javascript" src="https://mesibo.com/mesiboapi.js"></script> 
    <script type="text/javascript" src="scripts/utils.js"></script>
    <script type="text/javascript" src="scripts/localstorage.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <!--SCRIPTINCLUDEEND-->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles/chatdesign.css">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

</head>
<body>
<img src="images/mesibo-bg-white.png" style="height: 60px;">

<div class="messaging">
  <div class="inbox_msg">
	<div class="inbox_people">
	  <div class="headind_srch">
		<div class="recent_heading">
		  <h4>Messages</h4>
		</div>
		<div class="srch_bar">
		  <div class="stylish-input-group">
			<input type="text" class="search-bar"  placeholder="Search" >
			</div>
		</div>
	  </div>
	  <div class="inbox_chat scroll">
		<div class="chat_list active_chat">
		  <div class="chat_people">
			<div class="chat_img"> <img src="images/profile/man-1.png" alt="Jason"> </div>
			<div class="chat_ib">
			  <h5>Jason <span class="chat_date">6:26 pm</span></h5>
			  <p>Thanks..</p>
			</div>
		  </div>
		</div>
		<div class="chat_list">
		  <div class="chat_people">
			<div class="chat_img"> <img src="images/profile/girl-1.png" alt="Julia"> </div>
			<div class="chat_ib">
			  <h5>Julia <span class="chat_date">2:24 am</span></h5>
			  <p>Hey there! I am using Mesibo.</p>
			</div>
		  </div>
		</div>
		<div class="chat_list">
		  <div class="chat_people">
			<div class="chat_img"> <img src="images/profile/girl.png" alt="Jasonette"> </div>
			<div class="chat_ib">
			  <h5>Jasonette <span class="chat_date">Yesterday</span></h5>
			  <p>OK.</p>
			</div>
		  </div>
		</div>
		<div class="chat_list">
		  <div class="chat_people">
			<div class="chat_img"> <img src="images/profile/man.png" alt="sunil"> </div>
			<div class="chat_ib">
			  <h5>Jurgen<span class="chat_date">2:24 am</span></h5>
			  <p>What is the plan?</p>
			</div>
		  </div>
		</div>		
	  </div>
	</div>
	<div class="mesgs">
	  <div class="msg_history" id="msglist">
		<div class="incoming_msg">
		  <div class="received_msg">
			<div class="received_withd_msg">
			  <p>What is Mesibo?</p>
			  <span class="time_date_l"> 11:00 </span></div>
		  </div>
		</div>
		<div class="outgoing_msg">
		  <div class="sent_msg">
			<p>Mesibo offers everything to make your app real-time and scalable for your first billion users and the next. It's modular, lightweight and easy to integrate. </p>
			<img class=status_msg_img src="images/whatsapp_double_tick_coloured.png">

		  </div>
		</div>

	  </div>
	  <div class="type_msg">
		<div class="input_msg_write">
		  <input type="text" id="inputfield" class="write_msg" placeholder="Type a message" />
		  <button class="msg_send_btn" type="button" onclick="sendMessage()"><i class="fa fa-paper-plane" aria-hidden="true"></i></button> 
		</div>
	  </div>
	</div>
  </div>
</div>

 <script type="text/javascript">
      // localStorage.clear()
      
      var selected_user='917019882153';
      LocalStorage_LoadHistory(selected_user);
      function TestNotify() {
      }
  TestNotify.prototype.Mesibo_OnConnectionStatus = function(status, value) {
    console.log("TestNotify.prototype.Mesibo_OnConnectionStatus: "  + status);
    
  }
  TestNotify.prototype.Mesibo_OnMessageStatus = function(m) {
    console.log("TestNotify.prototype.Mesibo_OnMessageStatus: from "  + m.peer + " status: " + 
      m.status);

    m.peer='917019882153';
    
    LocalStorage_UpdateItemSent(m);

    var statustick=document.getElementById(m.id);
    updateStatusTick(statustick,m.status);
  }
  TestNotify.prototype.Mesibo_OnMessage = function(m, data) {
    console.log("TestNotify.prototype.Mesibo_OnMessage: from "  + m.peer);
    var string = new TextDecoder("utf-8").decode(data);

    console.log(m);
  
    if(m.flag==3){
    
    LocalStorage_UpdateItemRecieved(m,string);
    createRecievedBubble({'data':string,'ts':+ new Date});
    }

  }
     var accessToken = "4080ba6528abe3bdbef60cd497f9193199dadb6b635616e2216a80" 
        
     var api = new Mesibo();
     api.setAppName("dialogflowmesibo");
     api.setListener(new TestNotify());
     api.setCredentials(accessToken);
     api.start();

    function sendMessage() {
        var p = {};
        p.peer = "917019882153";
        var id = parseInt(Math.random()*10000);
        var msgdata="Mesibo test" ;

        msgdata= document.getElementById("inputfield").value;
      
        msg_payload={'id':id,'peer':p.peer,'params':p,'data':msgdata,'groupid':0,
        'ts': + new Date,'flag':0,'status':MESIBO_MSGSTATUS_OUTBOX};
      
        LocalStorage_NewItemSent(id,p.peer,msg_payload);
        createSentBubble(msg_payload);
      
        api.sendMessage(p,id,msgdata);
     }

     document.onkeydown = function (e) {
  		e = e || window.event;
  		switch (e.which || e.keyCode) {
        	case 13 : //Your Code Here (13 is ascii code for 'ENTER')
            	sendMessage();
            	break;
  	}

}
    </script>

</body>
</html>





 
